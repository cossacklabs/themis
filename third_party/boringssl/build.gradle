buildscript {
    repositories {
        google()
        jcenter()
    }

    dependencies {
        // Android Gradle plugin
        classpath 'com.android.tools.build:gradle:7.2.2'

        // Kotlin plugin for Android
        classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"
    }
}

repositories {
    google()
    jcenter()
}

apply plugin: 'com.android.library'
apply plugin: 'kotlin-android'

android {
    compileSdkVersion 30
    buildToolsVersion "30.0.3"
    ndkVersion "25.1.8937393"

    // BoringSSL requires at least API 21. Google Play as of August 2022 requires
    // to target at least API 30 (but we can still support lower versions).
    defaultConfig {
        minSdkVersion 21
        targetSdkVersion 30
        externalNativeBuild {
		    cmake {
		        arguments "-DCMAKE_TOOLCHAIN_FILE=" + android.ndkDirectory + "/build/cmake/android.toolchain.cmake",
		                  "-DANDROID_NATIVE_API_LEVEL=21",
		                  "-DCMAKE_BUILD_TYPE=Release",
		                  "-GNinja"
		        targets "crypto", "decrepit"
		    }
	    }
    }

    externalNativeBuild {
        cmake {
            path "src/CMakeLists.txt"
        }
    }

	sourceSets {
        main {
            manifest.srcFile 'AndroidManifest.xml'
        }
	}
}
